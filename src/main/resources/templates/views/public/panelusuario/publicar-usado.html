<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link th:href="@{/assets/css/styles.css}" rel="stylesheet" type="text/css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css"
          rel="stylesheet" crossorigin="anonymous">

    <title>PUBLICAR ARTÍCULO USADO</title>
</head>

<body>

<header>
    <a th:href="@{/}">
        <img th:src="@{/assets/img/logo.png}"
             alt="logo soluciones musicales" class="logo">
    </a>

    <div class="iconos">

        <!-- ICONO CARRITO -->
        <a th:href="@{/carrito}">
            <img th:src="@{/assets/img/carrito.png}" alt="logo carrito" class="logo">
        </a>

        <!-- ADMIN -->
        <a th:if="${#authorization.expression('hasRole(''ROLE_ADMIN'')')}"
           th:href="@{/paneladmin}">
            <img th:src="@{/assets/img/user.png}" alt="logo user" class="logo">
        </a>

        <!-- USUARIO LOGUEADO NORMAL -->
        <a th:if="${#authorization.expression('isAuthenticated()')
               and !#authorization.expression('hasRole(''ROLE_ADMIN'')')}"
           th:href="@{/inicio}">
            <img th:src="@{/assets/img/user.png}" alt="logo user" class="logo">
        </a>

        <!-- USUARIO INVITADO (ANÓNIMO) -->
        <a sec:authorize="isAnonymous()" th:href="@{/inicio}">
            <img th:src="@{/assets/img/user.png}" alt="logo user" class="logo">
        </a>

    </div>

    <div class="somos">
        <a th:href="@{/somos}">
            <h5>Quiénes somos?</h5>
        </a>
    </div>
</header>

<nav class="menu">

    <div class="btn-group">
        <button class="btn btn-secondary btn-lg dropdown-toggle" type="button"
                data-bs-toggle="dropdown" aria-expanded="false">
            GUITARRAS ELÉCTRICAS
        </button>
        <ul class="dropdown-menu">
            <li><a class="dropdown-item" th:href="@{/catalogos/guitarras/fender}">FENDER</a></li>
            <li><a class="dropdown-item" th:href="@{/catalogos/guitarras/gibson}">GIBSON</a></li>
            <li><a class="dropdown-item" th:href="@{/catalogos/guitarras/schecter}">SCHECTER</a></li>
        </ul>
    </div>

    <div class="btn-group">
        <button class="btn btn-secondary btn-lg dropdown-toggle" type="button"
                data-bs-toggle="dropdown" aria-expanded="false">
            BAJOS ELÉCTRICOS
        </button>
        <ul class="dropdown-menu">
            <li><a class="dropdown-item" th:href="@{/catalogos/bajos/fender}">FENDER</a></li>
            <li><a class="dropdown-item" th:href="@{/catalogos/bajos/ibanez}">IBANEZ</a></li>
            <li><a class="dropdown-item" th:href="@{/catalogos/bajos/schecter}">SCHECTER</a></li>
        </ul>
    </div>

</nav>

<div class="container my-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">

            <nav aria-label="breadcrumb" class="mb-4">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a th:href="@{/inicio}">Dashboard</a></li>
                    <li class="breadcrumb-item active" aria-current="page">Publicar Artículo Usado</li>
                </ol>
            </nav>

            <div class="form-container">

                <h2 class="text-center text-primary mb-4 pb-2 border-bottom">
                    Publicación Rápida de Producto Usado
                </h2>

                <p class="text-muted text-center mb-5">
                    Clasifica tu instrumento para que aparezca en el catálogo correcto.
                </p>

                <form th:action="@{/articulos/publicar}" method="POST" enctype="multipart/form-data">

                    <!-- CSRF -->
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

                    <div class="row g-3 mb-4">

                        <!-- TIPO -->
                        <div class="col-md-6">
                            <label for="tipo" class="form-label fw-bold">Tipo de Instrumento (*)</label>

                            <select class="form-select" id="tipo" name="tipoProducto"
                                    onchange="mostrarMarcas()" required>
                                <option value="" disabled selected>Selecciona tipo</option>
                                <option value="Guitarra">Guitarra Eléctrica</option>
                                <option value="Bajo">Bajo Eléctrico</option>
                            </select>
                        </div>

                        <!-- MARCAS -->
                        <div class="col-md-6">
                            <label for="marca" class="form-label fw-bold">Marca (*)</label>

                            <select class="form-select d-none" id="marcas_guitarras" name="marca" disabled>
                                <option value="" disabled selected>Selecciona marca</option>
                                <option value="Fender">FENDER</option>
                                <option value="Gibson">GIBSON</option>
                                <option value="Schecter">SCHECTER</option>
                            </select>

                            <select class="form-select d-none" id="marcas_bajos" name="marca" disabled>
                                <option value="" disabled selected>Selecciona marca</option>
                                <option value="Fender">FENDER</option>
                                <option value="Ibanez">IBANEZ</option>
                                <option value="Schecter">SCHECTER</option>
                            </select>

                            <select class="form-select" id="marca_placeholder" disabled>
                                <option value="">Elige primero el tipo</option>
                            </select>

                        </div>
                    </div>

                    <div class="mb-4">
                        <label for="nombre" class="form-label fw-bold">Nombre del Producto (*)</label>
                        <input type="text" class="form-control" id="nombre" name="nombre"
                               placeholder="Ej: Bajo Ibanez SR500" required maxlength="100">
                    </div>

                    <div class="mb-4">
                        <label for="descripcion" class="form-label fw-bold">Descripción (*)</label>
                        <textarea class="form-control" id="descripcion" name="descripcion"
                                  rows="4" required></textarea>
                    </div>

                    <div class="mb-4">
                        <label for="imagen" class="form-label fw-bold">Foto del Producto (*)</label>
                        <input class="form-control" type="file" id="imagen" name="imagen"
                               accept="image/*" required>
                    </div>

                    <div class="row g-3 mb-5">

                        <div class="col-md-6">
                            <label for="precio" class="form-label fw-bold">Precio (*)</label>
                            <div class="input-group">
                                <span class="input-group-text">$</span>
                                <input type="number" class="form-control" id="precio" name="precio"
                                       placeholder="1200000" min="1" required>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <label for="stock" class="form-label fw-bold">Cantidad/Stock (*)</label>
                            <input type="number" class="form-control" id="stock" name="stock"
                                   placeholder="1" min="1" required>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary btn-lg w-100">
                        Guardar Producto
                    </button>

                    <a th:href="@{/inicio}" class="btn btn-outline-secondary w-100 mt-3">
                        Cancelar y Volver al Panel
                    </a>
                </form>

            </div>
        </div>
    </div>
</div>

<footer class="bg-dark text-light mt-5 p-4">
    <div class="container">

        <div class="row">
            <div class="col-md-4">
                <h5>SOLUCIONES MUSICALES</h5>
                <p>Tu tienda de confianza en guitarras y bajos.</p>
            </div>

            <div class="col-md-4">
                <h5>Contacto</h5>
                <ul class="list-unstyled">
                    <li>+57 300 123 4567</li>
                    <li>contacto@solucionesmusicales.com</li>
                    <li>Neiva, Huila, Colombia</li>
                </ul>
            </div>

            <div class="col-md-4">
                <h5>Enlaces</h5>
                <ul class="list-unstyled">
                    <li><a th:href="@{/somos}" class="text-light text-decoration-none">¿Quiénes somos?</a></li>
                    <li><a href="#" class="text-light text-decoration-none">Guitarras</a></li>
                    <li><a href="#" class="text-light text-decoration-none">Bajos</a></li>
                    <li><a href="#" class="text-light text-decoration-none">Contacto</a></li>
                </ul>
            </div>
        </div>

        <hr class="border-light">

        <p class="text-center mb-0">
            &copy; 2025 Soluciones Musicales - Todos los derechos reservados
        </p>

    </div>
</footer>

<script>
    function mostrarMarcas() {
        const tipoSelect = document.getElementById('tipo');
        const marcaGuitarras = document.getElementById('marcas_guitarras');
        const marcaBajos = document.getElementById('marcas_bajos');
        const placeholder = document.getElementById('marca_placeholder');

        marcaGuitarras.classList.add('d-none');
        marcaBajos.classList.add('d-none');
        placeholder.style.display = 'none';

        marcaGuitarras.disabled = true;
        marcaBajos.disabled = true;

        if (tipoSelect.value === 'Guitarra') {
            marcaGuitarras.classList.remove('d-none');
            marcaGuitarras.disabled = false;
        } else if (tipoSelect.value === 'Bajo') {
            marcaBajos.classList.remove('d-none');
            marcaBajos.disabled = false;
        } else {
            placeholder.style.display = 'block';
        }
    }

    window.onload = mostrarMarcas;
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"
        crossorigin="anonymous"></script>

</body>
</html>
